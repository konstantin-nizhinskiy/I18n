/*
name: nks-i18n
version: 0.9.6
author: Konstantin Nizhinskiy
date: 2016-07-19 10:07:24 

*/
!function(a,b){"function"==typeof define&&define.amd?define("i18n",[],function(){return a.i18n=b()}):a.i18n=b()}(this,function(){var a=function(){this.setProperty({locale:"UA",localeDefault:"UA",versionJson:+new Date})},b="UA",c="UA",d={},e={};a.prototype.changeLocale=function(a){var b=[],c=this;for(var d in e)e[d][a]!==!0&&b.push(d);if(b.length>0){var f=b.length,h=function(){f--,0===f&&c.trigger("changeLocale",a)};g(a),b.forEach(function(a){c.load(a,h)})}else g(a),this.trigger("changeLocale",a)};var f={};a.prototype.on=function(a,b){"undefined"==typeof f[a]&&(f[a]={callback:[],callbackOnce:[]}),f[a].callback.push(b)},a.prototype.once=function(a,b){"undefined"==typeof f[a]&&(f[a]={callback:[],callbackOnce:[]}),f[a].callbackOnce.push(b)},a.prototype.off=function(a,b){var c;if("function"==typeof b){if(f[a].callback&&f[a].callback.length>0){c=[];for(var d=0;d<f[a].callback.length;d++)"function"==typeof f[a].callback[d]&&f[a].callback[d]!==b&&c.push(f[a].callback[d]);f[a].callback=c}if(f[a].callbackOnce&&f[a].callbackOnce.length>0){c=[];for(var d=0;d<f[a].callbackOnce.length;d++)"function"==typeof f[a].callbackOnce[d]&&f[a].callbackOnce[d]!==b&&c.push(f[a].callbackOnce[d]);f[a].callbackOnce=c}}else delete f[a]},a.prototype.trigger=function(a){if(f[a]){var b=[];for(var c in arguments)0!=c&&b.push(arguments[c]);if(f[a].callback&&f[a].callback.length>0)for(var d=0;d<f[a].callback.length;d++)"function"==typeof f[a].callback[d]&&f[a].callback[d].apply(this,b);if(f[a].callbackOnce&&f[a].callbackOnce.length>0){for(var d=0;d<f[a].callbackOnce.length;d++)"function"==typeof f[a].callbackOnce[d]&&f[a].callbackOnce[d].apply(this,b);f[a].callbackOnce=[]}}},a.prototype.get=function(a,b){var e;if(d[this.getLocale()]&&d[this.getLocale()][a]){if(e=d[this.getLocale()][a],"object"==typeof b)for(var f in b)e=e.replace(new RegExp("{{[ ]{0,}"+f+"[ ]{0,}}}","g"),b[f]);return e}if(this.trigger("error","error:translation:key",a,this.getLocale()),this.trigger("error:translation:key",a,this.getLocale()),c&&d[c]&&d[c][a]){if(e=d[c][a],"object"==typeof b)for(var f in b)e=e.replace(new RegExp("{{[ ]{0,}"+f+"[ ]{0,}}}","g"),b[f]);return e}return a},a.prototype.getLocale=function(){return b},a.prototype.load=function(a,b){if("undefined"==typeof e[a]&&(e[a]={}),"undefined"==typeof e[a][c]){var f=new XMLHttpRequest,g=this;f.open("GET",a+"."+c.toLowerCase()+".json?"+this._versionJson,!0),f.send(),f.onreadystatechange=function(){if(4==f.readyState)if(200!=f.status)g.trigger("error","error:load",f.statusText,f.status,f),g.trigger("error:load",f.statusText,f.status,f);else{var b=JSON.parse(f.responseText);if(e[a][c]=!0,"undefined"==typeof d[c])d[c]=b;else for(var h in b)d[c][h]||(d[c][h]=b[h])}}}if("undefined"==typeof e[a][this.getLocale()]){var h=new XMLHttpRequest,g=this;h.open("GET",a+"."+this.getLocale().toLowerCase()+".json?"+this._versionJson,!0),h.send(),h.onreadystatechange=function(){if(4==h.readyState)if(200!=h.status)g.trigger("error","error:load",h.statusText,h.status,h),g.trigger("error:load",h.statusText,h.status,h),"function"==typeof b&&b();else{var c=JSON.parse(h.responseText);if(e[a][g.getLocale()]=!0,"undefined"==typeof d[g.getLocale()])d[g.getLocale()]=c;else for(var f in c)d[g.getLocale()][f]||(d[g.getLocale()][f]=c[f]);g.trigger("load",a,e[a][g.getLocale()]),"function"==typeof b&&b()}}}else"function"==typeof b&&b()};var g=function(a){b=a};return a.prototype.setProperty=function(a){a.locale&&(b=a.locale),a.localDefault&&(c=a.localeDefault),a.versionJson&&(this._versionJson=a.versionJson)},new a});