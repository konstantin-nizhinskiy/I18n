/*
name: nks-i18n
version: 1.3.0
author: Konstantin Nizhinskiy
date: 2017-07-04 15:07:20 

*/
!function(a,b){"function"==typeof define&&define.amd?define([],function(){return a.i18n=b()}):"object"==typeof module&&module.exports?module.exports=a.i18n=b():a.i18n=b()}(this,function(){var a=function(){this.setProperty({locale:"UA",localeDefault:"UA",versionJson:+new Date})},b="UA",c="UA",d="",e={},f={};_modulePrefix={},a.prototype.changeLocale=function(a){var b=[],c=this;for(var d in f)f[d][a]!==!0&&b.push(d);if(b.length>0){var e=b.length,g=function(){e--,0===e&&c.trigger("changeLocale",a)};h(a),b.forEach(function(a){c.load(a,g)})}else h(a),this.trigger("changeLocale",a)};var g={};a.prototype.on=function(a,b){"undefined"==typeof g[a]&&(g[a]={callback:[],callbackOnce:[]}),g[a].callback.push(b)},a.prototype.once=function(a,b){"undefined"==typeof g[a]&&(g[a]={callback:[],callbackOnce:[]}),g[a].callbackOnce.push(b)},a.prototype.off=function(a,b){var c;if("function"==typeof b){if(g[a].callback&&g[a].callback.length>0){c=[];for(var d=0;d<g[a].callback.length;d++)"function"==typeof g[a].callback[d]&&g[a].callback[d]!==b&&c.push(g[a].callback[d]);g[a].callback=c}if(g[a].callbackOnce&&g[a].callbackOnce.length>0){c=[];for(var d=0;d<g[a].callbackOnce.length;d++)"function"==typeof g[a].callbackOnce[d]&&g[a].callbackOnce[d]!==b&&c.push(g[a].callbackOnce[d]);g[a].callbackOnce=c}}else delete g[a]},a.prototype.trigger=function(a){if(g[a]){var b=[];for(var c in arguments)0!=c&&b.push(arguments[c]);if(g[a].callback&&g[a].callback.length>0)for(var d=0;d<g[a].callback.length;d++)"function"==typeof g[a].callback[d]&&g[a].callback[d].apply(this,b);if(g[a].callbackOnce&&g[a].callbackOnce.length>0){for(var d=0;d<g[a].callbackOnce.length;d++)"function"==typeof g[a].callbackOnce[d]&&g[a].callbackOnce[d].apply(this,b);g[a].callbackOnce=[]}}},a.prototype.get=function(a,b,f){var g;if(e[this.getLocale()]&&e[this.getLocale()][a]){if(g=e[this.getLocale()][a],"object"==typeof b)for(var h in b)g=g.replace(new RegExp("{{[ ]{0,}"+h+"[ ]{0,}}}","g"),b[h]);return g}if(this.trigger("error","error:translation:key",a,this.getLocale()),this.trigger("error:translation:key",a,this.getLocale()),c&&e[c]&&e[c][a]){if(g=e[c][a],"object"==typeof b)for(var h in b)g=g.replace(new RegExp("{{[ ]{0,}"+h+"[ ]{0,}}}","g"),b[h]);return g}return f&&f.defaultValue?f.defaultValue:d?d:a},a.prototype.getLocale=function(){return b},a.prototype.load=function(a,b,d){if(d=d||{},d.modulePrefix&&_modulePrefix[d.modulePrefix]&&(a=_modulePrefix[d.modulePrefix]+a),"undefined"==typeof f[a]&&(f[a]={}),"undefined"==typeof f[a][c]&&this.getLocale()!==c){var g=new XMLHttpRequest,h=this;g.open("GET",a+"."+c.toLowerCase()+".json?"+this._versionJson,!0),g.send(),g.onreadystatechange=function(){if(4==g.readyState)if(200!=g.status)h.trigger("error","error:load",g.statusText,g.status,g),h.trigger("error:load",g.statusText,g.status,g);else{var b=JSON.parse(g.responseText);if(f[a][c]=!0,"undefined"==typeof e[c])e[c]=b;else for(var d in b)e[c][d]||(e[c][d]=b[d])}}}if("undefined"==typeof f[a][this.getLocale()]){var i=new XMLHttpRequest,h=this;i.open("GET",a+"."+this.getLocale().toLowerCase()+".json?"+this._versionJson,!0),i.send(),i.onreadystatechange=function(){if(4==i.readyState)if(200!=i.status)h.trigger("error","error:load",i.statusText,i.status,i),h.trigger("error:load",i.statusText,i.status,i),"function"==typeof b&&b();else{var c=JSON.parse(i.responseText);if(f[a][h.getLocale()]=!0,"undefined"==typeof e[h.getLocale()])e[h.getLocale()]=c;else for(var d in c)e[h.getLocale()][d]||(e[h.getLocale()][d]=c[d]);h.trigger("load",a,f[a][h.getLocale()]),"function"==typeof b&&b()}}}else"function"==typeof b&&b()};var h=function(a){b=a};return a.prototype.setProperty=function(a){a.locale&&(b=a.locale),a.localeDefault&&(c=a.localeDefault),a.versionJson&&(this._versionJson=a.versionJson),a.defaultValue&&(d=a.defaultValue),a.modulePrefix&&(_modulePrefix=a.modulePrefix)},new a});